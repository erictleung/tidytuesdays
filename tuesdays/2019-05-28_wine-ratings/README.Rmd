---
title: Global Plastic Waste
author: Eric Leung
---

## Introduction

> This week's dataset is a wine-enthusiast ratings dataset from Kaggle. H/t to
> Georgios Karamanis for sharing this week's dataset as an Issue on our GitHub!
> If you want to submit a dataset, please drop a link and some context as an
> issue. Thanks!
>
> An article with some interesting graphs (different dataset) can be found here.
> They found some clear relationships, but it also appears that cost is factored
> into their rating system. How does the Wine Enthusiast ratings scale compare?

## Load packages

```{r}
library(tidyverse)
library(sf)
library(maps)
```

## Load data

```{r}
wine_ratings <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-05-28/winemag-data-130k-v2.csv")
```

## Exploratory data analysis

**Number of countries**

```{r}
wine_ratings %>%
    distinct(country) %>%
    nrow()
```

**Range of points**

```{r}
wine_ratings %>%
    select(points) %>%
    range()
```

**Range of prices**

```{r}
wine_ratings %>%
    select(price) %>%
    range(na.rm = TRUE)
```

**Number of missing-ness in data**

Find lower bound on number of samples to use in exploration.

```{r}
# Calculate number of complete cases i.e. no NA values
wine_ratings %>%
    complete.cases() %>%
    sum()
```

## What is the distribution of words used in describing wine?

```{r}
wine_ratings

```

## What is the relationship between price and country?

```{r}
wine_ratings

```

## What is the relationship between points and country?

```{r}
wine_ratings

```

## What is the relationship between points and price?

```{r}
wine_ratings

```

## What is the specifics of Oregon-based wine?

Map higher quality wine with larger circles.

```{r}
# Gather Oregon map data
us_states <- map("state", plot = FALSE, fill = TRUE)
states_sf <- st_as_sf(us_states)
or_sf <- filter(states_sf, ID == "oregon")

# Manipulate wine data
wine_ratings %>%
    filter(province == "Oregon") %>%
    group_by(region_1) %>%
    mutate(avg_points = mean(points)) %>%
    mutate(avg_price = mean(price)) %>%
    mutate(avg_pts_prc = avg_points / avg_price)
```

```{r}
# Plot distribution of wine scores on Oregon
ggplot() +
    geom_sf(data = or_sf)
```

## Helpful resources

- https://mhallwor.github.io/_pages/Tidyverse_intro
- https://ggplot2.tidyverse.org/reference/ggsave.html
